TC.control=TC.control||{},TC.control.Scale||TC.syncLoadJS(TC.apiLocation+"TC/control/Scale"),TC.control.ScaleSelector=function(){var e=this;TC.control.Scale.apply(e,arguments),e.scales=null},TC.inherit(TC.control.ScaleSelector,TC.control.Scale),function(){var e=TC.control.ScaleSelector.prototype;e.CLASS="tc-ctl-ss",e.template=TC.isDebug?TC.apiLocation+"TC/templates/ScaleSelector.html":function(){function t(e,t){return e.w('<div class="ol-scale-line ol-unselectable"><nobr><select>').s(t.get(["scales"],!1),t,{block:n},{}).w('</select> <input type="button" value="').f(t.get(["screenSize"],!1),t,"h").w("''\" title=\"").h("i18n",t,{},{$key:"estimatedMapSize"}).w('" /></nobr></div>')}function n(e,t){return e.w('<option value="').f(t.getPath(!0,[]),t,"h").w('"').h("eq",t,{block:o},{key:c,value:l}).w(">1:").h("math",t,{},{key:i,method:"round"}).w("</option>\n")}function o(e,t){return e.w(' selected="true"')}function c(e,t){return e.f(t.getPath(!0,[]),t,"h")}function l(e,t){return e.f(t.get(["scale"],!1),t,"h")}function i(e,t){return e.f(t.getPath(!0,[]),t,"h")}return dust.register(e.CLASS,t),t.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,c.__dustBody=!0,l.__dustBody=!0,i.__dustBody=!0,t},e.render=function(e){var t=this;if(t.map){!t.scales&&t.map.options.resolutions&&(t.scales=t.map.options.resolutions.map(t.getScale,t));var n=function(){t.scales=t.map.wrap.getResolutions().map(t.getScale,t),$("input[type=button]",t._$div).off(),$("select",t._$div).off(),t.renderData({scale:t.getScale(),screenSize:TC.Cfg.screenSize,scales:t.scales},function(){t._$div.find("option").each(function(e,n){$elm=$(n),$elm.text("1:"+t.format($elm.text().substr(2)))}),t._$div.find('input[type="button"]').on(TC.Consts.event.CLICK,function(){t.setScreenSize.call(t)}),$("select",t._$div).on("change",function(){t.setScale($(this).val())}),$.isFunction(e)&&e()})};t.scales?n():$.when(t.map.wrap.getMap()).then(n)}},e.setScale=function(e){var t=this,n=.0254*e/t.getDpi(TC.Cfg.screenSize);return window.devicePixelRatio&&(n/=window.devicePixelRatio),t.metersPerDegree&&(n/=t.metersPerDegree),t.map.wrap.setResolution(n),n}}();