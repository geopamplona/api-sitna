TC.control=TC.control||{},TC.control.GeometryFeatureInfo||TC.syncLoadJS(TC.apiLocation+"TC/control/GeometryFeatureInfo"),function(){TC.control.PolygonFeatureInfo=function(){var t=this;TC.control.GeometryFeatureInfo.apply(this,arguments),t.geometryType=TC.Consts.geom.POLYGON},TC.inherit(TC.control.PolygonFeatureInfo,TC.control.GeometryFeatureInfo);var t=TC.control.PolygonFeatureInfo.prototype;t.CLASS="tc-ctl-finfo",t.template={},TC.isDebug?(t.template[t.CLASS]=TC.apiLocation+"TC/templates/FeatureInfo.html",t.template[t.CLASS+"-dialog"]=TC.apiLocation+"TC/templates/FeatureInfoDialog.html"):(t.template[t.CLASS]=function(){function e(t,e){return t.w('<ul class="tc-ctl-finfo-services">').s(e.get(["services"],!1),e,{"else":o,block:n},{}).w("</ul>").x(e.get(["featureCount"],!1),e,{block:L},{})}function o(t,e){return t.w('<li class="tc-ctl-finfo-empty">').h("i18n",e,{},{$key:"noData"}).w("</li>")}function n(t,e){return t.w("<li><h3>").x(e.getPath(!1,["mapLayer","title"]),e,{"else":l,block:c},{}).w('</h3><div class="tc-ctl-finfo-service-content">').s(e.get(["hasLimits"],!1),e,{"else":a,block:T},{}).w("</div></li>")}function l(t,e){return t.f(e.getPath(!1,["mapLayer","id"]),e,"h")}function c(t,e){return t.f(e.getPath(!1,["mapLayer","title"]),e,"h")}function a(t,e){return t.w('<ul class="tc-ctl-finfo-layers">').s(e.get(["layers"],!1),e,{"else":s,block:i},{}).w("</ul>")}function s(t,e){return t.w('<li class="tc-ctl-finfo-empty">').h("i18n",e,{},{$key:"noDataAtThisService"}).w("</li>")}function i(t,e){return t.w("<li><h4>").s(e.get(["path"],!1),e,{block:r},{}).w(' <span class="tc-ctl-finfo-layer-n">').f(e.getPath(!1,["features","length"]),e,"h").w('</span> </h4> <div class="tc-ctl-finfo-layer-content"><ul class="tc-ctl-finfo-features">').s(e.get(["features"],!1),e,{"else":d,block:f},{}).w("</ul></div></li>")}function r(t,e){return t.f(e.getPath(!0,[]),e,"h").h("sep",e,{block:u},{})}function u(t,e){return t.w(" &bull; ")}function d(t,e){return t.w('<li class="tc-ctl-finfo-empty">').h("i18n",e,{},{$key:"noDataInThisLayer"}).w("</li>")}function f(t,e){return t.w("<li>").x(e.get(["rawContent"],!1),e,{"else":y,block:m},{}).w("</li>")}function y(t,e){return t.x(e.get(["error"],!1),e,{"else":w,block:g},{})}function w(t,e){return t.w("<h5>").f(e.get(["id"],!1),e,"h").w("</h5><table").x(e.get(["geometry"],!1),e,{block:h},{}).w("><tbody>").s(e.get(["attributes"],!1),e,{block:_},{}).w("</tbody></table>").x(e.get(["geometry"],!1),e,{block:b},{})}function h(t,e){return t.w(' title="').h("i18n",e,{},{$key:"clickToCenter"}).w('"')}function _(t,e){return t.w('<tr><th class="tc-ctl-finfo-attr">').f(e.get(["name"],!1),e,"h").w('</th><td class="tc-ctl-finfo-val">').f(e.get(["value"],!1),e,"h").w("</td></tr>")}function b(t,e){return t.w('<div class="tc-ctl-finfo-tools"><button class="tc-ctl-finfo-tools-btn" title="').h("i18n",e,{},{$key:"download"}).w("/").h("i18n",e,{},{$key:"share"}).w('">').h("i18n",e,{},{$key:"download"}).w("/").h("i18n",e,{},{$key:"share"}).w("</button></div>")}function g(t,e){return t.w('<span class="tc-ctl-finfo-errors">').h("i18n",e,{},{$key:"fi.error"}).w('<span class="tc-ctl-finfo-error-text">').f(e.get(["error"],!1),e,"h").w("</span></span>")}function m(t,e){return t.w("<h5>").h("i18n",e,{},{$key:"feature"}).w("</h5>").h("eq",e,{"else":p,block:v},{key:e.get(["rawFormat"],!1),value:"text/html"})}function p(t,e){return t.w("<pre>").f(e.get(["rawContent"],!1),e,"h").w("</pre>")}function v(t,e){return t.w(" ").x(e.get(["expandUrl"],!1),e,{block:k},{})}function k(t,e){return t.h("ne",e,{"else":C,block:B},{key:e.get(["expandUrl"],!1),value:""})}function C(t,e){return t.w('<iframe src="').f(e.get(["rawUrl"],!1),e,"h").w('" />')}function B(t,e){return t.w('<div class="tc-ctl-finfo-features-iframe-cnt"><iframe src="').f(e.get(["rawUrl"],!1),e,"h").w('" /><a class="tc-ctl-finfo-open" onclick="window.open(\'').f(e.get(["expandUrl"],!1),e,"h").w("', '_blank')\" title=\"").h("i18n",e,{},{$key:"expand"}).w('"></a></div>')}function T(t,e){return t.w('<span class="tc-ctl-finfo-errors">').f(e.get(["hasLimits"],!1),e,"h").w("</span>")}function L(t,e){return t.h("gt",e,{block:S},{key:e.get(["featureCount"],!1),value:"1",type:"number"})}function S(t,e){return t.w('<a class="tc-ctl-btn tc-ctl-finfo-btn-prev">').h("i18n",e,{},{$key:"previous"}).w('</a><div class="tc-ctl-finfo-counter"><span class="tc-ctl-finfo-idx"></span>/').f(e.get(["featureCount"],!1),e,"h").w('</div><a class="tc-ctl-btn tc-ctl-finfo-btn-next">').h("i18n",e,{},{$key:"next"}).w("</a>")}return dust.register(t.CLASS,e),e.__dustBody=!0,o.__dustBody=!0,n.__dustBody=!0,l.__dustBody=!0,c.__dustBody=!0,a.__dustBody=!0,s.__dustBody=!0,i.__dustBody=!0,r.__dustBody=!0,u.__dustBody=!0,d.__dustBody=!0,f.__dustBody=!0,y.__dustBody=!0,w.__dustBody=!0,h.__dustBody=!0,_.__dustBody=!0,b.__dustBody=!0,g.__dustBody=!0,m.__dustBody=!0,p.__dustBody=!0,v.__dustBody=!0,k.__dustBody=!0,C.__dustBody=!0,B.__dustBody=!0,T.__dustBody=!0,L.__dustBody=!0,S.__dustBody=!0,e},t.template[t.CLASS+"-dialog"]=function(){function e(t,e){return t.w('<div class="tc-ctl-finfo-dialog tc-modal"><div class="tc-modal-background tc-modal-close"></div><div class="tc-modal-window"><div class="tc-modal-header"><h3>').h("i18n",e,{},{$key:"feature"}).w('</h3><div class="tc-ctl-popup-close tc-modal-close"></div></div><div class="tc-modal-body"><div class="tc-ctl-finfo-dialog-dl"><h2>').h("i18n",e,{},{$key:"download"}).w('</h2><div><button class="tc-button tc-ctl-finfo-dl-btn-kml" data-format="KML" title="KML">KML</button><button class="tc-button tc-ctl-finfo-dl-btn-gml" data-format="GML" title="GML">GML</button><button class="tc-button tc-ctl-finfo-dl-btn-geojson" data-format="GeoJSON" title="GeoJSON">GeoJSON</button><button class="tc-button tc-ctl-finfo-dl-btn-wkt" data-format="WKT" title="WKT">WKT</button></div></div><div class="tc-ctl-finfo-dialog-share"></div></div><div class="tc-modal-footer"><button type="button" class="tc-button tc-modal-close">').h("i18n",e,{},{$key:"close"}).w("</button></div></div></div>")}return dust.register(t.CLASS+"-dialog",e),e.__dustBody=!0,e})}();